---
title: "A Riverboat Card Trick"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(googlesheets)
library(dplyr)
library(ggformula)
library(mosaicCore)
library(mosaic)
knitr::opts_chunk$set(echo = FALSE)
```

```{r read_data, message = FALSE}
Cards <- gs_read(gs_key("1i1vGMNPiWiwmsF7kHMBrVAGGv5oUwssfzSYP9O6uqWg"))
```



The riverboat gambler is a character from pre-automobile days, playing cards on the boats that carried passengers and freight up- and downstream on the only viable long-distance transportation in the American interior: a riverboat. In this activity, you'll see a card trick involving a shuffle.

Please, if you know the trick, stay quiet until we ask for it to be revealed.


![](images/1200px-SteamboatBenCampbellb.jpg)

A Mississippi riverboat circa 1850. (Source: United States Library of Congress Prints and Photographs division: ID cph.3d02054.)

## The Riverboat Shuffle

On those long trips upriver, there was nothing much to talk about except how long the journey was. Colonel Freddy passes around the cards, asking the people in the boat's saloon to answer two questions about the length of the Mississippi river.

When you receive a card, **without showing your card to anyone else**, answer the two questions and write your initials at the top of the card. Not having a smoke-filled saloon we're going to use the internet to record your answer and do the fast shuffling by computer. [Here's the spreadsheet for entering your information.](https://docs.google.com/spreadsheets/d/1i1vGMNPiWiwmsF7kHMBrVAGGv5oUwssfzSYP9O6uqWg/edit?usp=sharing)

Once you have entered the card information, tear the card in half along the scissors line. Keep the half with your initials. Trade the upper half with another participant, then do it again with a different participant and so on. Do this as many times as you think necessary to mimic a card shuffle. Then, enter the card ID you are holding into your line in the spreadsheet. Repeat this shuffle 4 times altogether, entering the top-half number into the appropriate slot on your line of the spreadsheet.

## Dropping anchor

Unbeknownst to you, Colonel Freddy has arranged with the captain to stop the engines and drop anchor. This increases the tension in the saloon.

Here's Colonel Freddy's claim, which he makes once all the cards have been collected and the shuffling done. (In our language, that's after you've entered your data from the original deal and all four shuffles.)

> The card ID, even though it was dealt randomly, predicts in part your answer to question 2. But once you've torn the card in half and exchanged with other people, the magic connection fails and there's no relationship. 


## Stopping for t

To check Colonel Freddy's claim, let's do a linear regression of the answer to question 2 and the card ID:


```{r analysis, exercise=TRUE, exercise.setup = "read_data", exercise.cap = "Quantifying the relationship."}
lm(question2 ~ cardID, data = Cards)
```

The coefficient on `cardID` is the statistic we want. Write down your answers on a scrap piece of paper.

* Is it positive or negative? How big is it?
* Repeat the regression, substituting `shuffle_1` for `cardID`. Do the same for the other shuffles. For each of these, is the coefficient positive or negative? How big is it?



